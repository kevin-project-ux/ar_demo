<!DOCTYPE html>
<html>
  <head>
    <title>AR.js NFT A/B Example</title>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/AR-js-org/AR.js/aframe/build/aframe-ar-nft.min.js"></script>
  </head>
  <body style="margin:0;overflow:hidden;">
    <a-scene embedded arjs='sourceType: webcam; debugUIEnabled: false;'>
      <a-marker type='pattern' id="my-marker" url='./pattern-B.patt'>
<!--         <a-sphere color="blue" radius="0.5" position="0 0.5 0"></a-sphere> -->
        <a-text
          id="markerText"
          value=""
          position="0 1 0"
          align="center"
          color="white"
        ></a-text>
        <!-- 左邊虛擬按鈕 -->
        <a-plane
          position="-1 0.5 0"
          width="0.8"
          height="0.4"
          color="#FF4444"
          class="marker-button"
          visible="false"
        >
          <a-text
            value="開"
            color="white"
            align="center"
            position="0 0 0.01"
            scale="1 1 1"
          ></a-text>
        </a-plane>

        <!-- 右邊虛擬按鈕 -->
        <a-plane
          position="1 0.5 0"
          width="0.8"
          height="0.4"
          color="#44FF44"
          class="marker-button"
          visible="false"
        >
          <a-text
            value="關"
            color="white"
            align="center"
            position="0 0 0.01"
            scale="1 1 1"
          ></a-text>
        </a-plane>
      </a-marker>
    </a-scene>
    <script>
      const marker = document.querySelector("#my-marker");
      const text = document.querySelector("#markerText");

      marker.addEventListener("markerFound", () => {
        console.log("Marker found!");
        marker.querySelectorAll(".marker-button").forEach(btn => {
          btn.setAttribute("visible", true);
        });

        const patternUrl = marker.getAttribute("url"); // e.g., './pattern-A.patt'

        // 從檔名抓出 A（可支援 pattern-ABC123.patt）
        const match = patternUrl.match(/pattern-(.+)\.patt$/);
        const letter = match ? match[1] : "?";

        // 設定到文字元件上
        text.setAttribute("value", letter);
      });

      marker.addEventListener("markerLost", () => {
        console.log("Marker lost!");
        marker.querySelectorAll(".marker-button").forEach(btn => {
          btn.setAttribute("visible", false);
        });
        text.setAttribute("value", "");
      });

      document.querySelectorAll('.marker-button').forEach(el => {
        el.addEventListener('click', () => {
          alert('按下了按鈕');
        });
      });
    </script>
  </body>
</html>
